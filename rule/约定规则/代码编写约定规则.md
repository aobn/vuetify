# 📋 代码编写约定规则

## 1. 🛠 技术栈规范

### 1.1 核心技术
- **Vue 3.5.17+** - 使用 Composition API，享受最新特性
- **Vuetify 3.9.1+** - Material Design UI 组件库
- **TypeScript 5.0+** - 提供类型安全和更好的开发体验
- **Vite 6.3.5+** - 快速的构建工具和开发服务器
- **Vitest + Vue Test Utils** - 现代化测试框架

### 1.2 状态管理
- ✅ **推荐**: 使用 Pinia 进行状态管理
- ❌ **禁止**: 使用 Vuex（已过时）

### 1.3 项目目录结构
```
src/
├── assets/          # 静态资源
│   ├── images/      # 图片资源 (.png, .jpg, .svg)
│   ├── icons/       # 图标资源 (.svg, .ico)
│   └── fonts/       # 字体资源 (.woff, .woff2)
├── components/      # 组件目录
│   ├── common/      # 通用组件 (Button, Modal, Form等)
│   └── layout/      # 布局组件 (Header, Footer, Sidebar等)
├── layouts/         # 页面布局模板
├── pages/           # 页面组件 (路由对应的页面)
├── plugins/         # 插件配置 (vuetify, axios等)
├── router/          # 路由配置
├── stores/          # 状态管理 (Pinia stores)
├── styles/          # 样式文件 (全局样式, 变量等)
├── types/           # TypeScript 类型定义
└── utils/           # 工具函数 (helpers, constants等)
```

## 3. 🎯 Vue 组件编写规范

### 3.1 标准组件结构
```vue
<template>
  <v-card class="user-profile">
    <v-card-title>{{ displayTitle }}</v-card-title>
    <v-card-text>
      <v-btn 
        :loading="isLoading"
        @click="handleClick"
      >
        点击我
      </v-btn>
    </v-card-text>
  </v-card>
</template>

<script setup lang="ts">
// 1. 导入依赖
import { ref, computed } from 'vue'
import type { ComponentProps } from '@/types'

// 2. Props 定义
interface Props {
  title: string
  count?: number
}

const props = withDefaults(defineProps<Props>(), {
  count: 0
})

// 3. Events 定义
const emit = defineEmits<{
  'update:modelValue': [value: string]
  'change': [value: string]
}>()

// 4. 响应式数据
const isLoading = ref(false)

// 5. 计算属性
const displayTitle = computed(() => props.title.toUpperCase())

// 6. 方法定义
const handleClick = async () => {
  isLoading.value = true
  try {
    // 处理逻辑
    emit('change', 'new-value')
  } finally {
    isLoading.value = false
  }
}
</script>

<style scoped>
.user-profile {
  max-width: 400px;
}
</style>
```

### 3.2 Vuetify 组件使用规范
- ✅ **必须**: 使用 Vuetify 组件，禁止使用 Element UI 等其他组件库
- ✅ **推荐**: 使用 `vuetify-mcp` 工具获取组件 API 文档
- ✅ **遵循**: Vuetify Material Design 设计规范
- ✅ **优先**: 使用 Vuetify 内置的响应式系统和主题

### 3.3 Props 和 Events 最佳实践
```typescript
// ✅ 好的 Props 定义
interface Props {
  modelValue?: string
  disabled?: boolean
  variant?: 'filled' | 'outlined' | 'plain' | 'underlined'
  size?: 'small' | 'default' | 'large'
  color?: string
}

// ✅ 好的 Events 定义
const emit = defineEmits<{
  'update:modelValue': [value: string]
  'change': [value: string, oldValue: string]
  'click': [event: MouseEvent]
}>()
```

## 4. 🔷 TypeScript 规范

### 4.1 类型定义最佳实践
```typescript
// ✅ 接口定义 - 用于对象结构
interface User {
  readonly id: number
  name: string
  email: string
  avatar?: string
  createdAt: Date
  updatedAt: Date
}

// ✅ 类型别名 - 用于联合类型
type UserStatus = 'active' | 'inactive' | 'pending' | 'suspended'
type Theme = 'light' | 'dark' | 'auto'

// ✅ 泛型接口 - 用于通用数据结构
interface ApiResponse<T = unknown> {
  data: T
  message: string
  success: boolean
  code: number
}

// ✅ 实用类型 - 基于现有类型创建新类型
type CreateUserRequest = Omit<User, 'id' | 'createdAt' | 'updatedAt'>
type UpdateUserRequest = Partial<Pick<User, 'name' | 'email' | 'avatar'>>
```

### 4.2 类型导入导出规范
```typescript
// ✅ 导出类型
export type { User, UserStatus, Theme }
export type { ApiResponse, CreateUserRequest, UpdateUserRequest }

// ✅ 导入类型 - 使用 type 关键字
import type { User, UserStatus } from '@/types/user'
import type { ApiResponse } from '@/types/api'

// ✅ 混合导入
import { computed, ref } from 'vue'
import type { ComputedRef, Ref } from 'vue'
```

### 4.3 严格类型检查
```typescript
// ✅ 启用严格模式配置 (tsconfig.json)
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "noImplicitReturns": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true
  }
}

// ✅ 避免使用 any，使用具体类型
// ❌ 错误示例
const data: any = await fetchData()

// ✅ 正确示例
const data: ApiResponse<User[]> = await fetchData()
```

## 5. 🧪 测试规范

### 5.1 测试文件结构和命名
```
src/
├── components/
│   └── UserProfile.vue
└── __tests__/
    └── components/
        └── UserProfile.test.ts
```

### 5.2 标准测试模板
```typescript
import { describe, it, expect, beforeEach } from 'vitest'
import { mount, VueWrapper } from '@vue/test-utils'
import { createVuetify } from 'vuetify'
import * as components from 'vuetify/components'
import * as directives from 'vuetify/directives'
import UserProfile from '@/components/UserProfile.vue'
import type { User } from '@/types/user'

// 创建 Vuetify 实例
const vuetify = createVuetify({
  components,
  directives,
})

// 模拟数据
const mockUser: User = {
  id: 1,
  name: 'John Doe',
  email: 'john@example.com',
  createdAt: new Date(),
  updatedAt: new Date()
}

describe('UserProfile', () => {
  let wrapper: VueWrapper<any>

  beforeEach(() => {
    wrapper = mount(UserProfile, {
      global: {
        plugins: [vuetify]
      },
      props: {
        user: mockUser
      }
    })
  })

  it('应该正确渲染用户名称', () => {
    expect(wrapper.text()).toContain('John Doe')
  })

  it('应该正确处理点击事件', async () => {
    const button = wrapper.find('[data-testid="user-button"]')
    await button.trigger('click')
    
    expect(wrapper.emitted('click')).toBeTruthy()
  })

  it('应该正确响应 props 变化', async () => {
    await wrapper.setProps({
      user: { ...mockUser, name: 'Jane Doe' }
    })
    
    expect(wrapper.text()).toContain('Jane Doe')
  })
})
```

### 5.3 测试最佳实践
- ✅ **必须**: 为每个组件编写单元测试
- ✅ **推荐**: 使用真实数据而非过度模拟
- ✅ **重点测试**:
  - 组件渲染是否正确
  - Props 传递和响应
  - Events 触发和参数
  - 用户交互行为
  - 条件渲染逻辑
- ❌ **避免**: 测试实现细节，专注于用户行为

### 5.4 测试覆盖率要求
- **组件测试**: 覆盖率 ≥ 80%
- **工具函数**: 覆盖率 ≥ 90%
- **关键业务逻辑**: 覆盖率 = 100%



### 6.2 Vuetify 主题配置
```typescript
// src/plugins/vuetify.ts
import { createVuetify } from 'vuetify'
import { aliases, mdi } from 'vuetify/iconsets/mdi'

export default createVuetify({
  theme: {
    defaultTheme: 'dark', // 'light' | 'dark' | 'system'
  },
})
```

### 6.3 样式组织结构
```
src/styles/
├── variables.scss       # SCSS 变量
├── mixins.scss         # SCSS 混入
├── global.scss         # 全局样式
├── utilities.scss      # 工具类
└── components/         # 组件特定样式
    ├── buttons.scss
    └── forms.scss
```

### 6.4 响应式设计
```scss
// 使用 Vuetify 断点
.user-card {
  // 移动端
  @media (max-width: 599px) {
    padding: 8px;
  }
  
  // 平板端
  @media (min-width: 600px) and (max-width: 959px) {
    padding: 16px;
  }
  
  // 桌面端
  @media (min-width: 960px) {
    padding: 24px;
  }
}
```

## 6. 🔧 代码质量规范

### 6.1 ESLint 配置
```javascript
// .eslintrc.js
module.exports = {
  extends: [
    '@vue/eslint-config-typescript',
    '@vue/eslint-config-prettier',
    'plugin:vue/vue3-recommended',
  ],
  rules: {
    // Vue 规则
    'vue/component-name-in-template-casing': ['error', 'PascalCase'],
    'vue/no-unused-vars': 'error',
    'vue/require-default-prop': 'off',
    
    // TypeScript 规则
    '@typescript-eslint/no-unused-vars': 'error',
    '@typescript-eslint/explicit-function-return-type': 'off',
    '@typescript-eslint/no-explicit-any': 'warn',
  },
}
```

### 6.2 Prettier 配置
```json
// .prettierrc
{
  "semi": false,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 80,
  "endOfLine": "lf"
}
```





## 📝 更新记录
- **2025-08-30**: 初始版本创建，包含完整的开发规范